---
title: "《编程格调》--30 条代码风格帮你更好撸代码"
categories:
  - 读书
date: 2020-10-18T14:07:35+08:00
hidden: false
comments: true
draft: false
---

本书的作者之一是`Brian W. Kernighan`，一位著作颇丰的计算机科学家，代表作有《The C Programming Language》。本书是 Kernighan 的早期作品，介绍作者认为在编程中应该遵循的一些风格，有些风格笔者在编程中进行过实践，但没有像 Kernighan 这样进行系统性提炼和总结。笔者也借阅读本书把精华内容提炼出来，用于复习鞭策，也希望能帮助到大家。

![](https://raw.githubusercontent.com/alwqx/picx-images-hosting/master/common/reading/bcgd-arc.png)

<!--more-->

# 前言

Kernighan 在书籍的绪论中鲜明地提出了自己的观点：编写代码不是炫技，要确保代码的意图不会误解，过分聪明的程序会增加与原意发生偏离的风险。

这一观点奠定了全书的基调，即编写程序不是耍小聪明，而是让自己的程序简洁明了、可读性高。作者还警示，**过分聪明的代码调试难度是写程序的两倍**，如果你写程序的时候尽可能`聪明`，那么将来你将如何调试它？

# 表达

1. 简单并直接地表达你要说的意思
2. 不要自己造所有的工具，使用标准库函数
3. 让机器干脏活：计算机是处理反复操作的工具，我们要对重复样式/代码引起警觉并寻找疏漏，**程序员要学会让计算机处理重复**，用函数调用代替重复的表达式
4. 选择不易混淆的变量名
5. 使用语言好的特性，避免使用不好的特性
6. 保守使用临时变量，太多混乱的临时变量会让程序的读者懵逼，并且可能会对一个开了优化的编译器造成阻碍

# 控制结构

1. 用`if-else`强调两个操作只有一个被执行
2. 确保你的程序是自顶向下阅读的
3. 判断要尽可能挨着与之相关的操作
4. 不要止步于第一遍的代码草稿，尝试优化它

# 程序结构

1. 将程序模块化，每个模块专注于做好一件事
2. 不要修补烂代码，重写它
3. 分块编写和测试大型程序

# 输入和输出

1. 校验输入的合法性与合理性，保证输入不会违背程序的限制
2. 利用文件结束符或结束标志来终止输入
3. 让输入的数据易于校验
4. 使用含义明确的输入，指定默认值，将以上二者都输出

# 常见错误

1. 确保所有变量在使用之前被初始化
2. 10.0 乘以 0.1 不等于 1.0，浮点数不是绝对精确的，和 0.0 相等判断要谨慎
3. **不要比较浮点数是否相等**

# 效率

1. 先把程序改得简洁，再提高其运行速度
2. 保持简单性，程序反而会更快

# 文档

![](res/book.jpg)

1. **计算机程序最好的文档是代码清晰的结构**。如果代码格式很好，有合适的帮助记忆的标示符和标号，还有适量有启发性的注释，也是会很有帮助的。
2. 流程图和程序概述是次之的，**计算机程序唯一可靠的文档是代码本身**。原因很简单，当一段程序有多种写法时，其间的不同之处总是存在的。如果代码存在错误，优雅的流程图和详尽的注释都是没有用处的。**程序员确切懂得程序的唯一途径是阅读代码**。
3. 这并不是说程序员不要写文档。恰恰相反，在任何规模的项目中，对于每个程序应该做什么，程序怎样使用，程序与系统其他部分如何交互，以及程序基于何种原则。要维护好以上这些，具有可读性的文档是十分关键的。这些构成了阅读代码有用的向导。
4. 没有用处的是狭义的文档描述，即对程序所做事情逐行记流水账。**任何文档，如果没有贡献新的信息，而仅仅是重复代码的事情，都是多余的**。
5. 不要用注释复述代码做的事情，每个注释都要有实际意义。
6. 不要注释糟糕的代码，重写它
7. 程序的格式要有助于读者的理解
8. 不要过度注释

# 总结

本书分章节介绍了编程中的代码风格，每章都会基于观点然后列举代码进行说明。文章最后重点介绍了文档。写好文档的关键，在于良好的代码结构和简洁明了的代码。

需要注意的是，**低估编程格调的倾向，在程序员中普遍存在**。作者 Kernighan 列举了他认为应该遵守的编程格调，并进行阐述说明，希望这些风格能帮助程序员编写出更好的代码。
